/*
    Yara rule to extract WebInject targets from a browser memory dump
*/

rule WebInject {
    meta:
       description = "Extracts WebInject targets (URLs and regexes) from a browser mem dump"
       author = "conand"
       
    strings: 
        $URL = /((http[s\*]?:\/\/)|\*)[\*\/.0-9a-zA-Z-#]*\.(com|it|org|nl|uk|es|ru|net|ae|fr|de|bg)[\*\/.0-9a-zA-Z-]*/ fullword 

    condition:
        for any i in (1..#URL) : (@URL[i] < @URL[i-1] + 20)
}
